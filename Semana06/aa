import 'dart:io';

void main() {
  stdout.write('------------ Dulcería de Chocolates ------------\n');

  String tipoChocolate = leerTipoChocolate();
  int cantidadUnidades = leerCantidadUnidades();

  double precioUnitario = obtenerPrecio(tipoChocolate);
  double importeCompra = calcularImporte(precioUnitario, cantidadUnidades);
  double descuento = calcularDescuento(importeCompra, cantidadUnidades);
  double importeFinal = importeCompra - descuento;
  int caramelos = calcularCaramelos(importeFinal, cantidadUnidades);

  reporte(importeCompra, descuento, importeFinal, caramelos);
}

String leerTipoChocolate() {
  stdout.write(
      'Ingrese el tipo de chocolate (Primor, Dulzura, Tentación, Explosión): ');
  String? tipo = stdin.readLineSync();
  return tipo!.toLowerCase();
}

int leerCantidadUnidades() {
  stdout.write('Ingrese la cantidad de chocolates adquiridos: ');
  String? input = stdin.readLineSync();
  return int.parse(input!);
}

double obtenerPrecio(String tipo) {
  switch (tipo) {
    case 'primor':
      return 8.5;
    case 'dulzura':
      return 10.0;
    case 'tentación':
      return 7.0;
    case 'explosión':
      return 12.5;
    default:
      stdout.write(
          'Tipo de chocolate no válido. Se asignará el precio de Primor.\n');
      return 8.5;
  }
}

double calcularImporte(double precio, int cantidad) {
  return precio * cantidad;
}

double calcularDescuento(double importe, int cantidad) {
  double porcentajeDescuento;

  if (cantidad < 5) {
    porcentajeDescuento = 0.04; // 4%
  } else if (cantidad >= 5 && cantidad < 10) {
    porcentajeDescuento = 0.065; // 6.5%
  } else if (cantidad >= 10 && cantidad < 15) {
    porcentajeDescuento = 0.09; // 9%
  } else {
    porcentajeDescuento = 0.115; // 11.5%
  }

  return importe * porcentajeDescuento;
}

int calcularCaramelos(double importeFinal, int cantidad) {
  return importeFinal >= 250 ? cantidad * 3 : cantidad * 2;
}

void reporte(double importeCompra, double descuento, double importeFinal,
    int caramelos) {
  stdout.write('------------ Reporte ------------\n');
  stdout
      .write('Importe de la Compra: S/. ${importeCompra.toStringAsFixed(2)}\n');
  stdout.write('Importe del Descuento: S/. ${descuento.toStringAsFixed(2)}\n');
  stdout.write('Importe a Pagar: S/. ${importeFinal.toStringAsFixed(2)}\n');
  stdout.write('Cantidad de Caramelos de Obsequio: $caramelos\n');
  stdout.write('-----------------------------------\n');
}
